# 网络
## TCP/IP四层模型

## IP协议

1. IP报文数据格式

首部（Header）：
版本（IPv4 / IPv6）
首部长度
总长度
标识、标志、片偏移（用于分片与重组）
生存时间（TTL）
协议（TCP=6，UDP=17）
首部校验和
源 IP 地址、目的 IP 地址

数据部分（Payload）：承载上层协议数据（如 TCP、UDP）。

2. IP层路由机制

逐跳转发：路由器根据 目的 IP 地址 和 路由表决定转发接口。
最长前缀匹配：在路由表中选择匹配度最高的条目。
直连路由：如果目标 IP 在同一子网，直接通过 ARP 解析发送。
默认路由：如果没有更精确的匹配，使用默认网关。


## TCP协议
1. TCP连接建立的过程？

- 第一次握手：客户端向服务器发送 SYN 标志的数据包，表示请求建立连接，携带客户端的初始序列号 (seq=x)。
- 第二次握手：服务器接收请求，回复带有 SYN + ACK 标志的数据包，确认客户端的请求 (ack=x+1)，并携带自己的初始序列号 (seq=y)。
- 第三次握手：客户端收到确认后，发送 ACK 标志的数据包，确认服务器的序列号 (ack=y+1)，至此连接建立成功。

2. TCP拆除连接的过程？

- 第一次挥手：客户端向服务器发送 FIN 标志的数据包，表示数据发送完毕，申请关闭连接。
- 第二次挥手：服务器收到后，返回 ACK 标志的数据包，确认收到关闭请求，但此时仍可能有数据未发送完毕。
- 第三次挥手：服务器完成数据发送后，向客户端发送 FIN 标志的数据包，申请关闭连接。
- 第四次挥手：客户端收到后，发送 ACK 标志的数据包，确认关闭，进入 TIME_WAIT 状态，等待一段时间确保服务器已收到确认，之后彻底关闭连接。


## UDP协议

## 应用层协议

**HTTP**（HyperText Transfer Protocol，超文本传输协议）和 **HTTPS**（HyperText Transfer Protocol Secure，安全超文本传输协议）是互联网中最常用的通信协议，主要用于客户端（如浏览器）与服务器之间的数据传输。

**HTTP协议状态码**

|状态码|响应|
|--|--|
|1xx|信息性响应|
|2xx|成功|
|3xx|重定向|
|4xx|客户端错误|
|5xx|服务端错误|



## 新兴网络技术

### HTTP 2和 HTTP 3

### QUIC协议

基于 UDP 的新一代传输层协议，由 Google 提出。

特点：

- 内建 TLS 1.3 → 0-RTT/1-RTT 握手，更快建立连接。
- 多路复用 → 不同流之间相互独立，避免 TCP 的队头阻塞。
- 更好的丢包恢复机制 → 不依赖内核，优化拥塞控制。
- 连接迁移 → 支持在 IP 变化时保持连接（如 Wi-Fi 切换 4G）。

### BBR协议

全称：Bottleneck Bandwidth and Round-trip propagation time。
思路：不依赖丢包作为拥塞信号，而是 估计链路带宽和最小 RTT，动态调整发送速率。

优势：
- 高吞吐量，低延迟。
- 避免传统算法中队列膨胀（bufferbloat）问题。
- 对比 CUBIC/Reno：传统 TCP 通过丢包判断拥塞，容易导致突发抖动；BBR 更平滑。

## 高频面试问题
1. 从输入URL到浏览器显示结果中间经历了什么？

当用户在浏览器中输入 URL 并回车后，首先进行**DNS 解析**，将域名转换为 **IP** 地址，接着通过 **TCP 三次握手**（HTTPS 还需 TLS/SSL 握手）与服务器建立连接。然后，浏览器发送 **HTTP 请求**，服务器接收请求后处理，可能涉及数据库操作，生成并返回 **HTTP 响应**。浏览器接收响应后，解析 HTML 构建 DOM 树，解析 CSS 生成样式，执行 JavaScript，完成 布局（Layout） 和 绘制（Painting），最终将页面呈现给用户。期间，浏览器还会异步加载资源，处理用户交互，必要时更新页面。

2. 三次握手和四次挥手的原因？

三次握手原因：
- 确保双方通信能力：验证客户端和服务器都能接收与发送数据。
- 防止重复连接：避免历史的延迟数据包（如 SYN 包）被误认为是新的连接请求，导致连接异常。
四次挥手原因：
- 保证数据的完整性：TCP 是全双工通信，需要双方独立关闭，确保数据完全传输。
- 防止数据丢失：客户端进入 TIME_WAIT 状态，避免服务器未接收最后的 ACK，导致连接未正常关闭。

3. HTTP 1.0 1.1 和 1.2的区别？

|特性|HTTP 1.0| HTTP 1.1| HTTP 2.0|
|--|--|--|--|
|连接管理|短连接|长连接|多路复用|
|数据格式|文本|文本|二进制|
|请求并发|不支持|支持管道化|支持多路复用|
|头部压缩|无|无|HPACK 算法压缩头部|

4. 四次挥手的时候TIME_WAIT的作用

确保最后的 ACK 能被对方接收到（防止对方重传 FIN）。
确保旧连接中的延迟数据包在网络中消失，避免影响后续新连接。
代价：会占用一定端口资源。

5. QUIC为什么比TCP快

**握手更快**：QUIC 基于 UDP，结合 TLS 1.3，可实现 0-RTT 建连；TCP 需要三次握手 + TLS 握手。
**多路复用**：QUIC 避免 TCP 队头阻塞（一个流丢包不会阻塞其他流）。
**用户态实现**：无需操作系统内核升级，协议优化迭代更快。
**连接迁移**：支持在 IP/端口变化时保持连接，不必重新握手。

